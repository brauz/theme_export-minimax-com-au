function sc_pb_app_process(t){function e(){if(t(".sc-pb-element").length>0)var e=t(".sc-pb-element");else var e=t('a[href*="/products/"]:not(form a[href*="/products/"]):not(.related-products a[href*="/products/"])').has('img[src*="/products/"], img[src*="/no-image"]');var a={};return e.each(function(e,i){var r=t(i).attr("href").split("/"),n=r[r.length-1].split("?")[0];a[n]=i}),a}function a(){if(t(".sc-pb-element").length>0)var e=t(".sc-pb-element");else var e=t('img[src*="/products/"][src*="/cdn.shopify.com/s/files/"]').filter('[src*=".jpg"],[src*=".jpeg"],[src*=".png"]');var a,i=0;return e.each(function(t,e){var r=e.width;r>i&&(i=r,a=e)}),a}function i(t){var t=new Date(t),e=t.getFullYear(),a=t.getMonth()+1,i=t.getDate();return a+"/"+i+"/"+e}var r="/apps/product-badge",n="notice";search_result=function(e){SCPB.productListShopify={},t.each(e.Items,function(t,e){SCPB.productListShopify[e.handle]=e});for(var a in SCPB.imgElements){var i=SCPB.imgElements[a],r=t("img",i),n=r.parents(":not(a)").first();n.addClass("sc-badge-main"),r.before('<div class="sc-badge-container sc-badge-collection">'),objElement=t(i),t(".sc-badge-collection",n).css({width:objElement.width(),height:objElement.height(),"margin-left":SCPB.getBadgeMarginW(objElement),"margin-right":SCPB.getBadgeMarginW(objElement),"margin-top":SCPB.getBadgeMarginH(objElement),"margin-bottom":SCPB.getBadgeMarginH(objElement),padding:SCPB.getBadgePadding(objElement)});var o=SCPB.productListShopify[a];SCPB.activeVariant=o.variants[0],SCPB.showBadgeForProduct(o,i)}},SCPB.getVariantId=function(){var e=!1;"object"==typeof Shopify&&"function"==typeof Shopify.urlParam&&(e=Shopify.urlParam("variant"));var a="number"==typeof product_select_index?product_select_index:0;return e||(t("form[action='/cart/add'] select[name='id'] option:selected").length?e=t("form[action='/cart/add'] select[name='id'] option:selected")[a].value:t("form[action='/cart/add'] input[name='id']").length&&(e=t("form[action='/cart/add'] input[name='id']")[a].value,console.log("v",e))),e},SCPB.validateBadgeConditions=function(e,a){var r=!0,n=!0;if(n&&console.log("validation-start"),"yes"==e.on_sale){if(r)if(SCPB.activeVariant.hasOwnProperty("compare_at_price")&&null!=SCPB.activeVariant.compare_at_price){r=!1;var o=SCPB.activeVariant.compare_at_price-SCPB.activeVariant.price;parseFloat(e.min_discount_amount)&&o>=100*parseFloat(e.min_discount_amount)&&(r=!0),parseFloat(e.min_discount_percentage)&&o/SCPB.activeVariant.compare_at_price*100>=parseFloat(e.min_discount_percentage)&&(r=!0)}else r=!1}else"no"==e.on_sale;if(!r&&n&&console.log("on_sale"),"yes"==e["new"]){if((e.from_time||e.to_time)&&r&&(""!=e.from_time.trim()&&Date.parse(i(a.published_at))<Date.parse(e.from_time)&&(r=!1),""!=e.to_time.trim()&&r&&Date.parse(i(a.published_at))>Date.parse(e.to_time)&&(r=!1)),parseInt(e.last_days)&&r&&""==e.from_time.trim()&&""==e.to_time.trim()||!r&&(""!=e.from_time.trim()||""!=e.to_time.trim())){var c=new Date(a.published_at),s=new Date;c.setDate(c.getDate()+parseInt(e.last_days)),s>c?r=!1:r||(r=!0)}}else if("no"==e["new"]&&r&&((e.from_time||e.to_time)&&r&&(""!=e.from_time.trim()&&Date.parse(i(a.published_at))>=Date.parse(e.from_time)&&(r=!1),""!=e.to_time.trim()&&r&&Date.parse(i(a.published_at))<=Date.parse(e.to_time)&&(r=!1)),parseInt(e.last_days)&&r&&""==e.from_time.trim()&&""==e.to_time.trim()||!r&&(""!=e.from_time.trim()||""!=e.to_time.trim()))){var c=new Date(a.published_at),s=Date.now();c.setDate(c.getDate()+parseInt(e.last_days)),c>=s?r=!1:r||(r=!0)}if(!r&&n&&console.log("new"),e.collections&&r){r=!1;for(var p=e.collections.split(","),d=0;d<a.collections.length;d++){var g=a.collections[d];if(jQuery.inArray(g+"",p)>=0){r=!0;break}}}if(!r&&n&&console.log("collection"),"avail"==e.stock){if(r){r=!1;for(var d=0;d<a.variants.length;d++){var l=a.variants[d];if(l.inventory_quantity>0||!l.hasOwnProperty("inventory_management")){r=!0;break}}}}else if("not_avail"==e.stock){if(r)for(var d=0;d<a.variants.length;d++){var l=a.variants[d];if(l.inventory_quantity>0||!l.hasOwnProperty("inventory_management")){r=!1;break}}}else if("low_stock"==e.stock&&r){r=!1,min_qty=e.stock_min_qty?parseInt(e.stock_min_qty):1,min_qty&&min_qty<=0&&(min_qty=1);for(var d=0;d<a.variants.length;d++){var l=a.variants[d];if(l.inventory_quantity>0&&l.inventory_quantity<=min_qty&&l.hasOwnProperty("inventory_management")){r=!0;break}}}if(!r&&n&&console.log("stock"),(e.hasOwnProperty("from_price")||e.hasOwnProperty("to_price"))&&r&&(e.hasOwnProperty("from_price")&&""!=e.from_price&&SCPB.activeVariant.price<100*parseFloat(e.from_price)&&(r=!1),e.hasOwnProperty("to_price")&&""!=e.to_price&&r&&1==r&&SCPB.activeVariant.price>100*parseFloat(e.to_price)&&(r=!1)),!r&&n&&console.log("from_price - to_price: "),"ex_sel_variant"==e.v_option){if(r){var m=e.variant_list.split(",");-1!=t.inArray(SCPB.activeVariant.id+"",m)&&(r=!1)}}else if("sel_variant_only"==e.v_option&&r){r=!1;var m=e.variant_list.split(",");-1!=t.inArray(SCPB.activeVariant.id+"",m)&&(r=!0)}return!r&&n&&console.log("V_option"),n&&console.log("validation-end: ",r),r},SCPB.showBadge=function(e,a,i,n,o,c,s,p,d,g,l){var m;if(m=a?t(".sc-badge-container .sc-badge-img[data-sc-badge-id='"+i+"']",a):t(".sc-badge-container .sc-badge-img[data-sc-badge-id='"+i+"']"),m.length>0)m.first().show();else{var _='<div data-sc-badge-id="'+i+'" class="sc-badge-img '+n+'" style="background-size: cover; background-image: url(\''+r+c+"'); width: "+(s?s:30)+("true"==d?"px":"%")+"; height: "+(p?p:30)+("true"==d?"px":"%")+";"+l+' ">';if(o){var v=o;if(v.indexOf("##SAVE_PERCENTAGE##")>=0){var u=0;SCPB.activeVariant.hasOwnProperty("compare_at_price")&&SCPB.activeVariant.price<SCPB.activeVariant.compare_at_price&&(u=(SCPB.activeVariant.compare_at_price-SCPB.activeVariant.price)/SCPB.activeVariant.compare_at_price*100,u=Math.round(100*u)/100),v=v.replace("##SAVE_PERCENTAGE##",u)}if(v.indexOf("##SAVE_AMOUNT##")>=0){var f=0;SCPB.activeVariant.hasOwnProperty("compare_at_price")&&SCPB.activeVariant.price<SCPB.activeVariant.compare_at_price&&(f=(SCPB.activeVariant.compare_at_price-SCPB.activeVariant.price)/100);var P=sc_pb_money_format.replace("{{amount}}",f);v=v.replace("##SAVE_AMOUNT##",P)}if(v.indexOf("##PRODUCT_PRICE##")>=0){var h=sc_pb_money_format.replace("{{amount}}",SCPB.activeVariant.price/100);v=v.replace("##PRODUCT_PRICE##",h)}if(v.indexOf("##NEW_DAYS##")>=0){var B=(Date.parse(e.published_at)-new Date)/864e5;v=v.replace("##NEW_DAYS##",B)}v.indexOf("##PRODUCT_SKU##")>=0&&(SCPB.activeVariant.hasOwnProperty("sku")?""!=SCPB.activeVariant.sku&&(v=v.replace("##PRODUCT_SKU##",SCPB.activeVariant.sku)):v=""),v.indexOf("##PRODUCT_QUANTITY##")>=0&&(SCPB.activeVariant.hasOwnProperty("inventory_quantity")&&SCPB.activeVariant.hasOwnProperty("inventory_management")?SCPB.activeVariant.inventory_quantity>0&&SCPB.activeVariant.inventory_management&&(v=v.replace("##PRODUCT_QUANTITY##",SCPB.activeVariant.inventory_quantity)):v="");var S=g;_+='<span class="sc-badge-content" style="'+(S?S:"")+'">'+v+"</span>"}_+="</div>","product"==SCPB.page?jQuery(".sc-badge-container").append(_):jQuery(".sc-badge-container",a).append(_)}},SCPB.showBadgeForProduct=function(t,e){var a=!1,i=SCPB.badges;for(var r in i){var n=i[r],o=n.logics;if(a)break;a="1"===n.enabled?SCPB.validateBadgeConditions(o,t):!1,a&&("product"==SCPB.page?SCPB.showBadge(t,e,n.id,n.product.imgOptions.position,n.product.imgOptions.text,n.product.imgOptions.url,n.product.imgOptions.badge_width,n.product.imgOptions.badge_height,n.product.imgOptions.in_px,n.product.imgOptions.text_styles,n.product.imgOptions.badge_styles):SCPB.showBadge(t,e,n.id,n.collection.imgOptions.position,n.collection.imgOptions.text,n.collection.imgOptions.url,n.collection.imgOptions.badge_width,n.collection.imgOptions.badge_height,n.collection.imgOptions.in_px,n.collection.imgOptions.text_styles,n.collection.imgOptions.badge_styles))}return null},SCPB.getBadgeMarginW=function(t,e){var a=(t.outerWidth()-t.innerWidth(),t.innerWidth()-t.width(),t.outerWidth(!0)-t.outerWidth());return a/2},SCPB.getBadgeMarginH=function(t,e){var a=(t.outerHeight()-t.innerHeight(),t.innerHeight()-t.height(),t.outerHeight(!0)-t.outerHeight());return a/2},SCPB.getBadgePadding=function(t,e){var a=(t.outerWidth()-t.innerWidth(),t.innerWidth()-t.width());t.outerWidth(!0)-t.outerWidth();return a},SCPB.bindBadges=function(){if("product"===SCPB.page){t(".sc-badge-container .sc-badge-img").hide();var i=a(),r=t(i),n=r.parents(":not(a)").first();if(n.addClass("sc-badge-main"),r){r.before('<div class="sc-badge-container">'),t(".sc-badge-container").css({width:r.width(),height:r.height(),"margin-left":SCPB.getBadgeMarginW(r),"margin-right":SCPB.getBadgeMarginW(r),"margin-top":SCPB.getBadgeMarginH(r),"margin-bottom":SCPB.getBadgeMarginH(r),padding:SCPB.getBadgePadding(r)});var o=null,c=SCPB.getVariantId();if(c){for(var s=SCPB.product,p=0;p<s.variants.length;p++)if(c==s.variants[p].id){o=s.variants[p];break}}else o=SCPB.product.variants[0];SCPB.activeVariant=o,null!=o&&SCPB.showBadgeForProduct(s,i)}}else{SCPB.imgElements=e();var d="";for(var g in SCPB.imgElements)d.length>0&&(d+=" OR "),d+='handle:"'+g+'"';t.getScript("/search?q="+d+"&view=sc-pb-front-25052016")}},SCPB.page=SCPB.page.split(".")[0],t.inArray(SCPB.page,["index","collection","product"])>=0&&(t.ajax({type:"GET",url:"/apps/product-badge/app-front/app-front/get_all_badges",dataType:"json",async:!1,success:function(t,e,a){t.type==n&&(SCPB.badges=JSON.parse(t.text),SCPB.bindBadges())}}),t.ajax({type:"GET",url:"/apps/product-badge/app-front/app-front/get_settings",dataType:"json",async:!1,success:function(e,a,i){e.type==n&&(e=JSON.parse(e.text),t("body").append("<style>"+e.custom_css+"</style>"))}})),SCPB.update_variant=function(e){SCPB.activeVariant=e,t(".sc-badge-container").empty();var i=a();SCPB.showBadgeForProduct(SCPB.product,i)}}